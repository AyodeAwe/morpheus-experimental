## DGA Detection via AppShield

### Requirements 
To run this example, additional requirements must be installed into your environment. A supplementary requirements file has been provided in this example directory.

```bash 
pip install -r requirements.txt
```

### Training
Training data consists of 320K labelled as DGA domains of 17 known DGA families and 710K labelled as not DGA domains.

To train the model run the following script under working directory.
```bash
cd ${MORPHEUS_EXPERIMENTAL_ROOT}/appshield-dga-detection/training-tuning

# Run training script and save models

python dga-appshield-cnn-training.py
```
This saves trained model files under `../models` directory. Then the inference script can load the models for future inferences.

### Model Overview
This model is a convolution neural network model trained to classify URL domains generated by Domain-Generation-Algorithms. Domain generation algorithms (DGA) are algorithms seen in various families of malware that are used to periodically generate a large number of domain names that can be used as rendezvous points with their command and control servers.
### Model Architecture
There are two models for this use case. Both are CNNs. One is a binary classifier (DGA or benign), and the other classifies the specific DGA family the URL belongs to.

### How To Use This Model
Combined with host data from DOCA AppShield, this model can be used to detect DGA malware. A training notebook is also included so that users can update the model as more labeled data is collected. 
#### Input
This model is based on DOCA AppShield and the input of the model is the URL plugin which contains list of URLs connected to host processes.
#### Output
Binary classifier outputs process with URLs classified as DGA or benign. DGA family detection classifier outputs DGA family name.
